SQL ‚Äì Part II

Ximena Ebertz
xebertz@campus.ungs.edu.ar

Hern√°n Rondelli
lucifer.unix.cabj@gmail.com

* rondelli.github.io/db1/com-1/sql-2.html

.image img/rondelli.github.io-db1-com-1-sql-2.html.png 500 _

* order by

* order by

	select *
	from   empleade
	order  by salario;
 
	select *
	from   empleade
	order  by salario desc;
 
	select *
	from   empleade
	order  by salario asc;
 
	select *
	from   empleade
	order  by apellido, nombre;

* Subqueries

* select ‚Ä¶ where ‚Ä¶ (select ‚Ä¶)

 select nombre, salario
 from empleade
 where salario >= (
     select salario
     from empleade
     where legajo = 626
 );

* all

 select nombre, apellido
 from empleade
 where salario > all (
     select salario
     from empleade
     where departamento = 'sistemas'
 );

* in

 select nombre, apellido, departamento
 from  empleade
 where departamento in (
     select departamento
     from proyecto
     where fecha_inicio >= '2011-06-26'
 );

* exists

 select e1.nombre, e1.apellido
 from empleade e1
 where not exists (
     select *
     from empleade e2
     where departamento = 'sistemas' and e2.salario >= e1.salario
 );

* Funciones de agregaci√≥n

* Funciones de agregaci√≥n‚Ä¶

	select count(*) from empleade;
 
	select count(nombre) from empleade;
 
	select count(distinct nombre) from empleade;

* ‚Ä¶Funciones de agregaci√≥n

	select sum(salario) from empleade;
 
	select max(salario) from empleade;
 
	select min(salario) from empleade;
 
	select avg(salario) from empleade;
 
	select max(salario), min(salario), avg(salario) from empleade;

* group by

* group by

	select   departamento, count(*), avg(salario)
	from     empleade
	group by departamento;
 
	select   departamento, count(*), salario
	from     empleade
	group by departamento, salario;
 
	select   departamento, count(*), avg(salario)
	from     empleade
	where    departamento = 'sistemas' or departamento = 'finanzas'
	group by departamento;

* having

	select   departamento, avg(salario) 
	from     empleade 
	group by departamento 
	having   count(*) > 10;

# *having* s√≥lo puede hacer referencia a funciones de agregaci√≥n √≥ a campos que est√©n en el *group*by*.

* having √≥ where ü§î

	select   departamento, count(*) 
	from     empleade 
	where    salario >= 40000
	group by departamento 
	having   count(*) > 10;
 
	select   departamento, count(*) 
	from     empleade 
	where    salario >= 40000 and departamento in (select   departamento
	                                               from     empleade
	                                               group by departamento
	                                               having   count(*) > 10)
	group by departamento;  

* Operaciones de conjuntos

* union

	select nombre, apellido from docente
	union
	select nombre, apellido from alumne;
 
	select nombre, apellido from docente
	union all
	select nombre, apellido from alumne;

* intersect

	select nombre, apellido from docente
	intersect
	select nombre, apellido from alumne;
 
	select nombre, apellido from docente
	intersect all
	select nombre, apellido from alumne;

* except

	select nombre, apellido from docente
	except
	select nombre, apellido from alumne;
 
	select nombre, apellido from docente
	except all
	select nombre, apellido from alumne;

* One more thing‚Ä¶

* divisi√≥n

Empleades que trabajan en todos los proyectos.
 
 select distinct legajo
 from trabaja_en t1
 where not exists (
     select 1
     from proyecto p
     where not exists (
         select 1
         from trabaja_en t2
         where t2.legajo = t1.legajo and t2.proyecto_id = p.proyecto_id
     )
 );

# empty title
* 

.image img/questions.png
